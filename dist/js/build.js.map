{"version":3,"sources":["app.js","controllers.js","directives.js","filters.js","main.js","services.js"],"names":["angular","module","run","$rootScope","$state","$stateParams","config","$httpProvider","defaults","headers","post","Content-Type","transformRequest","obj","str","p","push","encodeURIComponent","join","$stateProvider","$urlRouterProvider","otherwise","state","url","templateUrl","controller","$scope","hour","Date","getHours","mode","day","name","loadingPage","showLoading","httpService","getData","then","data","bannerList","banner","recommendList","recommend","slideIndex","renderFinish","setTimeout","Swipe","$","startSlide","speed","auto","continuous","disableScroll","stopPropagation","callback","index","elem","$digest","transitionEnd","topicList","myKeyup","e","keyCode","search","searchText","lastClick","console","log","gap","query","searchResult","showResult","blur","hideResult","id","params","topicId","topicInfo","setEllipsis","each","i","divH","this","height","$p","eq","outerHeight","text","replace","mediaList","isfocus","mediaId","mediaInfo","focus","action","postData","media_id","status","alert","message","cookieService","get","userInfo","css","medias","length","switchMode","exit","go","feedback","showFeed","sendFeed","md5","username","password","login","createHash","register","test","res","hasCollect","articleId","article","collect","article_id","directive","restrict","template","link","scope","element","attr","on","window","history","back","$last","$eval","repeatFinish","filter","date","t","split","d","actiondate","month","getMonth","getFullYear","getDate","doc","win","docEl","documentElement","resizeEvt","recalc","clientWidth","minSize","maxSize","minWidth","maxWidth","scale","fontSize","style","addEventListener","document","FastClick","attach","body","animate","position","scrollTop","scroll","bottom","factory","service","cookieName","cookieStart","cookie","indexOf","cookieValue","cookieEnd","decodeURIComponent","substring","$q","$http","deferred","defer","promise","method","resolve","reject"],"mappings":"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","file":"build.js","sourcesContent":["angular.module('myApp', ['ui.router', 'angular-md5', 'directives', 'services', 'filters', 'RecommendModule', 'TopicModule', 'MediaModule', 'AccountModule', 'ArticleModule'])\r\n    .run(['$rootScope', '$state', '$stateParams', function($rootScope, $state, $stateParams) {\r\n        $rootScope.$state = $state;\r\n        $rootScope.$stateParams = $stateParams;\r\n    }])\r\n    .config(['$httpProvider', function($httpProvider) {\r\n        //request payload, 转换成form data\r\n        $httpProvider.defaults.headers.post = {\r\n            'Content-Type': 'application/x-www-form-urlencoded'\r\n        };\r\n        $httpProvider.defaults.transformRequest = function(obj) {\r\n            var str = [];\r\n            for (var p in obj) str.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(obj[p]));\r\n            return str.join(\"&\");\r\n        };\r\n    }])\r\n    .config(['$stateProvider', '$urlRouterProvider', function($stateProvider, $urlRouterProvider) {\r\n        $urlRouterProvider.otherwise('/tab/recommend');\r\n\r\n        $stateProvider.state('tab', {\r\n                url: '/tab',\r\n                templateUrl: 'dist/tpl/tab.html',\r\n            })\r\n            .state('tab.recommend', {\r\n                url: '/recommend',\r\n                templateUrl: 'dist/tpl/recommend.html',\r\n                controller: 'RecommendCtrl'\r\n            })\r\n            .state('tab.topic', {\r\n                url: '/topic',\r\n                templateUrl: 'dist/tpl/topic.html',\r\n                controller: 'TopicCtrl'\r\n            })\r\n            .state('tab.media', {\r\n                url: '/media',\r\n                templateUrl: 'dist/tpl/media.html',\r\n                controller: 'MediaCtrl'\r\n            })\r\n            .state('tab.me', {\r\n                url: '/me',\r\n                templateUrl: 'dist/tpl/me.html'\r\n            })\r\n            .state('tab.me.account', {\r\n                url: '/account',\r\n                templateUrl: 'dist/tpl/account.html',\r\n                controller: 'AccountCtrl'\r\n            })\r\n            .state('tab.me.login', {\r\n                url: '/login',\r\n                templateUrl: 'dist/tpl/login.html',\r\n                controller: 'LoginCtrl'\r\n            })\r\n            .state('tab.me.register', {\r\n                url: '/register',\r\n                templateUrl: 'dist/tpl/register.html',\r\n                controller: 'RegisterCtrl'\r\n            })\r\n            .state('topicDetail', {\r\n                url: '/topic/:topicId',\r\n                templateUrl: 'dist/tpl/topicDetail.html',\r\n                controller: 'TopicDetailCtrl'\r\n            })\r\n            .state('mediaDetail', {\r\n                url: '/media/:mediaId',\r\n                templateUrl: 'dist/tpl/mediaDetail.html',\r\n                controller: 'MediaDetailCtrl'\r\n            })\r\n            .state('article', {\r\n                url: '/article/:articleId',\r\n                templateUrl: 'dist/tpl/article.html',\r\n                controller: 'ArticleCtrl'\r\n            })\r\n    }])\r\n    .controller('AppCtrl', ['$scope', function($scope) {\r\n\r\n        var hour = (new Date()).getHours();\r\n        $scope.mode = {};\r\n        if (hour > 7 && hour < 23) {\r\n            $scope.mode.day = true;\r\n            $scope.mode.name = \"日间\";\r\n        } else {\r\n            $scope.mode.day = false;\r\n            $scope.mode.name = \"夜间\";\r\n        }\r\n\r\n        $scope.loadingPage = {\r\n            'showLoading': false\r\n        };\r\n    }])","angular.module(\"RecommendModule\", [])\r\n    .controller('RecommendCtrl', ['$scope', 'httpService', function($scope, httpService) {\r\n        $scope.loadingPage.showLoading = true;\r\n        httpService.getData('/article/get_recommend')\r\n            .then(function(data) {\r\n                $scope.bannerList = data.banner;\r\n                $scope.recommendList = data.recommend;\r\n                $scope.loadingPage.showLoading = false;\r\n            });\r\n        $scope.slideIndex = 0;\r\n        $scope.renderFinish = function() {\r\n            setTimeout(function() {\r\n                new Swipe($(\".recommend #slide\")[0], {\r\n                    startSlide: 0,\r\n                    speed: 400,\r\n                    auto: 3000,\r\n                    continuous: true,\r\n                    disableScroll: false,\r\n                    stopPropagation: false,\r\n                    callback: function(index, elem) {\r\n                        $scope.slideIndex = index > 2 ? index % 3 : index;\r\n                        $scope.$digest();\r\n                    },\r\n                    transitionEnd: function(index, elem) {\r\n\r\n                    }\r\n                });\r\n            }, 0);\r\n        }\r\n    }]);\r\n\r\nangular.module(\"TopicModule\", [\"ngSanitize\"])\r\n    .controller('TopicCtrl', ['$scope', 'httpService', function($scope, httpService) {\r\n\r\n        $scope.loadingPage.showLoading = true;\r\n        httpService.getData('/topic/get_topic')\r\n            .then(function(data) {\r\n                $scope.topicList = data;\r\n                $scope.loadingPage.showLoading = false;\r\n            });\r\n        $scope.myKeyup = function(e) {\r\n            if (e.keyCode == 13) {\r\n                $scope.search($scope.searchText);\r\n            }\r\n        };\r\n        var lastClick = 0;\r\n        $scope.search = function(searchText) {\r\n            if (lastClick) {\r\n                console.log(lastClick);\r\n                var gap = +(new Date()) - lastClick;\r\n                console.log(gap);\r\n                if (gap < 1000) {\r\n                    return false;\r\n                }\r\n                lastClick = +(new Date());\r\n            }\r\n            httpService.getData('/article/search', {\r\n                    query: searchText\r\n                })\r\n                .then(function(data) {\r\n                    $scope.searchResult = data;\r\n                    $scope.showResult = true;\r\n                    $(\".search > input\").blur();\r\n                });\r\n            lastClick = +(new Date());\r\n\r\n        }\r\n        $scope.hideResult = function() {\r\n            $scope.showResult = false;\r\n            $scope.searchText = \"\";\r\n        }\r\n    }])\r\n    .controller('TopicDetailCtrl', ['$scope', '$state', 'httpService', function($scope, $state, httpService) {\r\n        $scope.loadingPage.showLoading = true;\r\n        httpService.getData('/topic/get_one_topic', {\r\n                id: $state.params.topicId\r\n            })\r\n            .then(function(data) {\r\n                $scope.topicInfo = data;\r\n                $scope.loadingPage.showLoading = false;\r\n            });\r\n        $scope.setEllipsis = function() {\r\n            setTimeout(function() {\r\n                $(\".topic-article .summary\").each(function(i) {\r\n                    var divH = $(this).height();\r\n                    var $p = $(\"p\", $(this)).eq(0);\r\n                    while ($p.outerHeight() > divH) {\r\n                        $p.text($p.text().replace(/(\\s)*([a-zA-Z0-9]+|\\W)(\\.\\.\\.)?$/, \"...\"));\r\n                    };\r\n                });\r\n            })\r\n        };\r\n\r\n    }]);\r\n\r\nangular.module(\"MediaModule\", [])\r\n    .controller('MediaCtrl', ['$scope', 'httpService', function($scope, httpService) {\r\n        $scope.loadingPage.showLoading = true;\r\n        httpService.getData('/media/get_media')\r\n            .then(function(data) {\r\n                $scope.mediaList = data;\r\n                $scope.loadingPage.showLoading = false;\r\n            });\r\n        $scope.setEllipsis = function() {\r\n            setTimeout(function() {\r\n                $(\".media .intro\").each(function(i) {\r\n                    var divH = $(this).height();\r\n                    var $p = $(\"p\", $(this)).eq(0);\r\n                    while ($p.outerHeight() > divH) {\r\n                        $p.text($p.text().replace(/(\\s)*([a-zA-Z0-9]+|\\W)(\\.\\.\\.)?$/, \"...\"));\r\n                    };\r\n                });\r\n            })\r\n        };\r\n\r\n    }])\r\n    .controller('MediaDetailCtrl', ['$scope', '$state', 'httpService', function($scope, $state, httpService) {\r\n        $scope.isfocus = false;\r\n        $scope.loadingPage.showLoading = true;\r\n        httpService.getData('/media/get_one_media', {\r\n                id: $state.params.mediaId\r\n            })\r\n            .then(function(data) {\r\n                $scope.mediaInfo = data;\r\n                $scope.isfocus = !!$scope.mediaInfo['is_focus'];\r\n                $scope.loadingPage.showLoading = false;\r\n            });\r\n        $scope.focus = function() {\r\n            var action;\r\n            if ($scope.isfocus) {\r\n                action = 0;\r\n            } else {\r\n                action = 1;\r\n            }\r\n            httpService.postData('/user/focus_media', {\r\n                    media_id: $state.params.mediaId,\r\n                    action: action\r\n                })\r\n                .then(function(data) {\r\n                    if (!data.status) {\r\n                        alert(data.message);\r\n                    } else {\r\n                        if (action) {\r\n                            alert(\"已成功关注！\");\r\n                            $scope.isfocus = true;\r\n                        } else {\r\n                            alert(\"已取消关注！\");\r\n                            $scope.isfocus = false;\r\n                        }\r\n                    }\r\n                });\r\n\r\n        }\r\n    }]);\r\n\r\nangular.module(\"AccountModule\", [])\r\n    .controller('AccountCtrl', ['$scope', '$state', 'cookieService', 'httpService', function($scope, $state, cookieService, httpService) {\r\n        console.log(cookieService.get(\"zw_username\"));\r\n        if (!cookieService.get(\"zw_username\")) {\r\n            console.log(\"go\");\r\n            $state.go(\"tab.me.login\");\r\n            $scope.loadingPage.showLoading = false;\r\n            return false;\r\n        }\r\n\r\n        $scope.loadingPage.showLoading = true;\r\n        httpService.getData('/user/get_detail')\r\n            .then(function(data) {\r\n                $scope.userInfo = data;\r\n                $(\".attention-list\").css(\"width\", (9.78 * $scope.userInfo.medias.length) + \"rem\");\r\n                $scope.loadingPage.showLoading = false;\r\n            });\r\n        $scope.switchMode = function() {\r\n            $scope.mode.day = !$scope.mode.day;\r\n            if ($scope.mode.day) {\r\n                $scope.mode.name = \"日间\";\r\n            } else {\r\n                $scope.mode.name = \"夜间\";\r\n            }\r\n        }\r\n\r\n        $scope.exit = function() {\r\n            cookieService.exit();\r\n            $state.go(\"tab.me.login\");\r\n        }\r\n\r\n        $scope.feedback = function() {\r\n            $scope.showFeed = true;\r\n        }\r\n\r\n        $scope.sendFeed = function() {\r\n            alert(\"感谢您的反馈！我们会努力做的更好！\")\r\n            $scope.showFeed = false;\r\n        };\r\n\r\n        // $scope.initScroll = function() {\r\n        //     console.log(2);\r\n        //     setTimeout(function() {\r\n        //         var myScroll = new IScroll('.scroll', {\r\n        //             scrollX: true,\r\n        //             scrollY: false,\r\n        //             mouseWheel: true\r\n        //         });\r\n        //     }, 5000);\r\n        // }\r\n\r\n    }])\r\n    .controller('LoginCtrl', ['$scope', '$state', 'md5', 'httpService', function($scope, $state, md5, httpService) {\r\n        $scope.username = \"\";\r\n        $scope.password = \"\";\r\n        $scope.login = function() {\r\n            if ($scope.username == \"\" || $scope.password == \"\") {\r\n                alert(\"请填写用户名或密码！\");\r\n                return false;\r\n            }\r\n            httpService.postData('/user/login', {\r\n                    username: $scope.username,\r\n                    password: md5.createHash($scope.password)\r\n                })\r\n                .then(function(data) {\r\n                    if (data.status) {\r\n                        $state.go(\"tab.me.account\");\r\n                    } else {\r\n                        alert(data.message);\r\n                    }\r\n                });\r\n        };\r\n    }])\r\n    .controller('RegisterCtrl', ['$scope', '$state', 'md5', 'httpService', function($scope, $state, md5, httpService) {\r\n        $scope.username = \"\";\r\n        $scope.password = \"\";\r\n        $scope.register = function() {\r\n            if ($scope.username == \"\" || $scope.password == \"\") {\r\n                alert(\"请填写用户名或密码！\");\r\n                return false;\r\n            }\r\n            if (!/^([a-zA-Z0-9_\\.\\-])+\\@(([a-zA-Z0-9\\-])+\\.)+([a-zA-Z0-9]{2,4})+$/.test($scope.username)) {\r\n                alert(\"请填写正确的邮箱格式！\");\r\n                return false;\r\n            }\r\n            httpService.postData('/user/register', {\r\n                    username: $scope.username,\r\n                    password: md5.createHash($scope.password)\r\n                })\r\n                .then(function(data) {\r\n                    if (res.data.status) {\r\n                        alert(\"注册成功\");\r\n                        $state.go(\"tab.me.account\");\r\n                    } else {\r\n                        alert(data.message);\r\n                    }\r\n                });\r\n        };\r\n    }]);\r\n\r\nangular.module(\"ArticleModule\", [\"ngSanitize\"])\r\n    .controller('ArticleCtrl', ['$scope', '$state', 'cookieService', 'httpService', function($scope, $state, cookieService, httpService) {\r\n\r\n        $scope.hasCollect = false;\r\n        $scope.loadingPage.showLoading = true;\r\n        httpService.getData('/article/get_one_article', {\r\n                id: $state.params.articleId\r\n            })\r\n            .then(function(data) {\r\n                $scope.article = data;\r\n                $scope.hasCollect = !!$scope.article['is_focus'];\r\n                $scope.loadingPage.showLoading = false;\r\n            });\r\n\r\n        $scope.collect = function() {\r\n            if (!cookieService.get('zw_username')) {\r\n                alert(\"收藏文章请先登录！\");\r\n                return false;\r\n            }\r\n            $scope.hasCollect = !$scope.hasCollect;\r\n            var action;\r\n            if ($scope.hasCollect) {\r\n                action = 1;\r\n            } else {\r\n                action = 0;\r\n            }\r\n\r\n            httpService.postData('/user/collect_article', {\r\n                article_id: $state.params.articleId,\r\n                action: action\r\n            });\r\n        };\r\n\r\n    }]);","angular.module('directives', [])\r\n\r\n.directive('historyBack', function() {\r\n    return {\r\n        restrict: 'E',\r\n        template: '<div class=\"history-back\"><i class=\"icon-back\"></i></div>',\r\n        replace: true,\r\n        link: function(scope, element, attr) {\r\n            element.on('click', function() {\r\n                window.history.back();\r\n            })\r\n        }\r\n    }\r\n})\r\n\r\n.directive('repeatFinish', function() {\r\n    return {\r\n        link: function(scope, element, attr) {\r\n            if (scope.$last == true) {\r\n                scope.$eval(attr.repeatFinish)\r\n            }\r\n        }\r\n    }\r\n})","angular.module('filters', [])\r\n\r\n.filter('dateObj', function() {\r\n    return function(date) {\r\n        if (!date) {\r\n            return;\r\n        }\r\n        // console.log(date);\r\n        // var date = new Date(date);\r\n        var t = date.split(/[- :]/);\r\n        // console.log(t);\r\n        // Apply each element to the Date function\r\n        var d = new Date(t[0], t[1] - 1, t[2], t[3], t[4], t[5]);\r\n        // console.log(d);\r\n        var actiondate = new Date(d);\r\n        return actiondate;\r\n    }\r\n})\r\n\r\n.filter('month', function() {\r\n    return function(date) {\r\n        if (!date) {\r\n            return;\r\n        }\r\n        var month = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'June', 'July', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec'];\r\n        return month[date.getMonth()] + ', ' + date.getFullYear();\r\n    }\r\n})\r\n\r\n.filter('day', function() {\r\n    return function(date) {\r\n        if (!date) {\r\n            return;\r\n        }\r\n        var month = ['January', 'February', 'March', 'April', 'May', 'June',\r\n            'July', 'Aguest', 'September', 'October', 'November', 'December'\r\n        ];\r\n        var day = date.getDate();\r\n        if (day < 10) {\r\n            day = '0' + day;\r\n        }\r\n        return month[date.getMonth()] + ', ' + day + ', ' + date.getFullYear();;\r\n    }\r\n})","(function(doc, win) {\r\n    var docEl = doc.documentElement,\r\n        resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',\r\n        recalc = function() {\r\n            var clientWidth = docEl.clientWidth;\r\n            if (!clientWidth) {\r\n                return;\r\n            }\r\n            var minSize = 12;\r\n            var maxSize = 16;\r\n            var minWidth = 320;\r\n            var maxWidth = 768;\r\n            var scale = (clientWidth - minWidth) / (maxWidth - minWidth);\r\n            var fontSize = scale * (maxSize - minSize) + minSize;\r\n\r\n            if (fontSize > maxSize) {\r\n                fontSize = maxSize;\r\n            } else if (fontSize < minSize) {\r\n                fontSize = minSize;\r\n            }\r\n            docEl.style.fontSize = fontSize + 'px';\r\n        };\r\n\r\n    if (!doc.addEventListener) return;\r\n    win.addEventListener(resizeEvt, recalc, false);\r\n    doc.addEventListener('DOMContentLoaded', recalc, false);\r\n})(document, window);\r\n\r\n$(function() {\r\n    FastClick.attach(document.body);\r\n\r\n    var animate = false;\r\n    var position = $(window).scrollTop();\r\n    $(window).scroll(function() {\r\n        var scroll = $(window).scrollTop();\r\n        if (scroll > position && !animate && $(\"#myTab\").length) {\r\n            animate = true;\r\n            $(\"#myTab\").animate({\r\n                \"bottom\": \"-4.4rem\",\r\n            }, 300, function() {\r\n                animate = false;\r\n            });\r\n        } else if (scroll < position && !animate && $(\"#myTab\").length) {\r\n            animate = true;\r\n            $(\"#myTab\").animate({\r\n                \"bottom\": \"0\",\r\n            }, 300, function() {\r\n                animate = false;\r\n            });\r\n        }\r\n        position = scroll;\r\n    });\r\n});","angular.module('services', [])\r\n\r\n.factory('cookieService', function() {\r\n        var service = {\r\n            get: function(name) {\r\n                var cookieName = encodeURIComponent(name) + \"=\";\r\n                var cookieStart = document.cookie.indexOf(cookieName);\r\n                var cookieValue = \"\";\r\n\r\n                if (cookieStart > -1) {\r\n                    var cookieEnd = document.cookie.indexOf(\";\", cookieStart);\r\n                    if (cookieEnd == -1) {\r\n                        cookieEnd = document.cookie.length;\r\n                    }\r\n                    cookieValue = decodeURIComponent(document.cookie.substring(cookieStart + cookieName.length, cookieEnd));\r\n                }\r\n                return cookieValue;\r\n            },\r\n            exit: function() {\r\n                document.cookie = 'zw_username=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/;';\r\n            }\r\n        };\r\n        return service;\r\n    })\r\n    .service('httpService', ['$q', '$http', function($q, $http) {\r\n        this.getData = function(url, params) {\r\n            var deferred = $q.defer();\r\n            var promise = deferred.promise;\r\n\r\n            $http({\r\n                method: 'GET',\r\n                url: '/zuiwan-backend/index.php' + url,\r\n                params: params\r\n            }).then(function successCallback(res) {\r\n                // console.log(res.data);\r\n                deferred.resolve(res.data);\r\n            }, function errorCallback(res) {\r\n                console.log(res.data);\r\n                deferred.reject(res.data);\r\n            });\r\n            return promise;\r\n        };\r\n        this.postData = function(url, data) {\r\n            var deferred = $q.defer();\r\n            var promise = deferred.promise;\r\n\r\n            $http({\r\n                method: 'POST',\r\n                url: '/zuiwan-backend/index.php' + url,\r\n                data: data\r\n            }).then(function successCallback(res) {\r\n                // console.log(res.data);\r\n                deferred.resolve(res.data);\r\n            }, function errorCallback(res) {\r\n                console.log(res.data);\r\n                deferred.reject(res.data);\r\n            });\r\n            return promise;\r\n        }\r\n    }]);"],"sourceRoot":"/source/"}