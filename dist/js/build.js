angular.module("myApp",["ui.router","angular-md5","directives","services","filters","RecommendModule","TopicModule","MediaModule","AccountModule","ArticleModule"]).run(["$rootScope","$state","$stateParams",function(t,e,l){t.$state=e,t.$stateParams=l}]).config(["$httpProvider",function(t){t.defaults.headers.post={"Content-Type":"application/x-www-form-urlencoded"},t.defaults.transformRequest=function(t){var e=[];for(var l in t)e.push(encodeURIComponent(l)+"="+encodeURIComponent(t[l]));return e.join("&")}}]).config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/tab/recommend"),t.state("tab",{url:"/tab",templateUrl:"dist/tpl/tab.html"}).state("tab.recommend",{url:"/recommend",templateUrl:"dist/tpl/recommend.html",controller:"RecommendCtrl"}).state("tab.topic",{url:"/topic",templateUrl:"dist/tpl/topic.html",controller:"TopicCtrl"}).state("tab.media",{url:"/media",templateUrl:"dist/tpl/media.html",controller:"MediaCtrl"}).state("tab.me",{url:"/me",templateUrl:"dist/tpl/me.html"}).state("tab.me.account",{url:"/account",templateUrl:"dist/tpl/account.html",controller:"AccountCtrl"}).state("tab.me.login",{url:"/login",templateUrl:"dist/tpl/login.html",controller:"LoginCtrl"}).state("tab.me.register",{url:"/register",templateUrl:"dist/tpl/register.html",controller:"RegisterCtrl"}).state("topicDetail",{url:"/topic/:topicId",templateUrl:"dist/tpl/topicDetail.html",controller:"TopicDetailCtrl"}).state("mediaDetail",{url:"/media/:mediaId",templateUrl:"dist/tpl/mediaDetail.html",controller:"MediaDetailCtrl"}).state("article",{url:"/article/:articleId",templateUrl:"dist/tpl/article.html",controller:"ArticleCtrl"})}]).controller("AppCtrl",["$scope",function(t){var e=(new Date).getHours();t.mode={},e>7&&23>e?(t.mode.day=!0,t.mode.name="日间"):(t.mode.day=!1,t.mode.name="夜间"),t.loadingPage={showLoading:!1}}]);
angular.module("RecommendModule",[]).controller("RecommendCtrl",["$scope","$http",function(e,o){e.loadingPage.showLoading=!0,o({method:"GET",url:"/zuiwan-backend/index.php/article/get_recommend"}).then(function(o){console.log(o),e.bannerList=o.data.banner,e.recommendList=o.data.recommend,e.loadingPage.showLoading=!1},function(e){console.log(e)}),e.renderFinish=function(){setTimeout(function(){new Swipe($(".recommend #slide")[0],{startSlide:0,speed:400,auto:3e3,continuous:!0,disableScroll:!1,stopPropagation:!1,callback:function(e,o){var e=e>2?e%3:e;$("#slide .dot > span").eq(e).addClass("active").siblings().removeClass("active")},transitionEnd:function(e,o){}})},0)}}]),angular.module("TopicModule",["ngSanitize"]).controller("TopicCtrl",["$scope","$http",function(e,o){e.loadingPage.showLoading=!0,o({method:"GET",url:"/zuiwan-backend/index.php/topic/get_topic"}).then(function(o){console.log(o),e.topicList=o.data,e.loadingPage.showLoading=!1},function(e){console.log(e)}),e.myKeyup=function(o){13==o.keyCode&&e.search(e.searchText)};var n=0;e.search=function(t){if(n){console.log(n);var a=+new Date-n;if(console.log(a),1e3>a)return!1;n=+new Date}o({method:"GET",url:"/zuiwan-backend/index.php/article/search",params:{query:t}}).then(function(o){console.log(o.data),e.searchResult=o.data,e.showResult=!0,$(".search > input").blur()},function(e){console.log(e)}),n=+new Date},e.hideResult=function(){e.showResult=!1,e.searchText=""}}]).controller("TopicDetailCtrl",["$scope","$http","$state",function(e,o,n){e.loadingPage.showLoading=!0,o({method:"GET",url:"/zuiwan-backend/index.php/topic/get_one_topic",params:{id:n.params.topicId}}).then(function(o){console.log(o),e.topicInfo=o.data,e.date=new Date,e.loadingPage.showLoading=!1},function(e){console.log(e)})}]),angular.module("MediaModule",[]).controller("MediaCtrl",["$scope","$http",function(e,o){e.loadingPage.showLoading=!0,o({method:"GET",url:"/zuiwan-backend/index.php/media/get_media"}).then(function(o){console.log(o.data),e.mediaList=o.data,e.loadingPage.showLoading=!1},function(e){console.log(e)}),e.setEllipsis=function(){setTimeout(function(){$(".media .intro").each(function(e){for(var o=$(this).height(),n=$("p",$(this)).eq(0);n.outerHeight()>o;)n.text(n.text().replace(/(\s)*([a-zA-Z0-9]+|\W)(\.\.\.)?$/,"..."))})})}}]).controller("MediaDetailCtrl",["$scope","$http","$state",function(e,o,n){e.isfocus=!1,e.loadingPage.showLoading=!0,o({method:"GET",url:"/zuiwan-backend/index.php/media/get_one_media",params:{id:n.params.mediaId}}).then(function(o){console.log(o),e.mediaInfo=o.data,e.isfocus=!!e.mediaInfo.is_focus,e.loadingPage.showLoading=!1},function(e){console.log(e)}),e.focus=function(){var t;t=e.isfocus?0:1,o({method:"POST",url:"/zuiwan-backend/index.php/user/focus_media",data:{media_id:n.params.mediaId,action:t}}).then(function(o){o.data.status?t?(alert("已成功关注！"),e.isfocus=!0):(alert("已取消关注！"),e.isfocus=!1):alert(o.data.message)},function(e){})}}]),angular.module("AccountModule",[]).controller("AccountCtrl",["$scope","$http","$state","cookieService",function(e,o,n,t){return e.loadingPage.showLoading=!0,t.get("zw_username")?(e.switchMode=function(){e.mode.day=!e.mode.day,e.mode.day?e.mode.name="日间":e.mode.name="夜间"},e.exit=function(){t.exit(),n.go("tab.me.login")},e.feedback=function(){e.showFeed=!0},e.sendFeed=function(){alert("感谢您的反馈！我们会努力做的更好！"),e.showFeed=!1},e.initScroll=function(){setTimeout(function(){new IScroll(".scroll",{scrollX:!0,scrollY:!1,mouseWheel:!0})},0)},void o({method:"GET",url:"/zuiwan-backend/index.php/user/get_detail"}).then(function(o){console.log(o),e.userInfo=o.data,$(".attention-list").css("width",9.78*e.userInfo.medias.length+"rem"),e.loadingPage.showLoading=!1},function(e){console.log(e)})):(console.log("go"),n.go("tab.me.login"),e.loadingPage.showLoading=!1,!1)}]).controller("LoginCtrl",["$scope","$http","$state","md5",function(e,o,n,t){e.username="",e.password="",e.login=function(){return""==e.username||""==e.password?(alert("请填写用户名或密码！"),!1):void o({method:"POST",url:"/zuiwan-backend/index.php/user/login",data:{username:e.username,password:t.createHash(e.password)}}).then(function(e){console.log(e.data),e.data.status?n.go("tab.me.account"):alert(e.data.message)},function(e){console.log(e)})}}]).controller("RegisterCtrl",["$scope","$http","$state","md5",function(e,o,n,t){e.username="",e.password="",e.register=function(){return""==e.username||""==e.password?(alert("请填写用户名或密码！"),!1):/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e.username)?void o({method:"POST",url:"/zuiwan-backend/index.php/user/register",data:{username:e.username,password:t.createHash(e.password)}}).then(function(e){console.log(e.data),e.data.status?(alert("注册成功"),n.go("tab.me.account")):alert(e.data.message)},function(e){alert("请求失败")}):(alert("请填写正确的邮箱格式！"),!1)}}]),angular.module("ArticleModule",["ngSanitize"]).controller("ArticleCtrl",["$scope","$http","$state","cookieService",function(e,o,n,t){e.hasCollect=!1,e.loadingPage.showLoading=!0,o({method:"GET",url:"/zuiwan-backend/index.php/article/get_one_article",params:{id:n.params.articleId}}).then(function(o){console.log(o),e.article=o.data,e.hasCollect=!!e.article.is_focus,e.loadingPage.showLoading=!1},function(e){}),e.collect=function(){if(!t.get("zw_username"))return alert("收藏文章请先登录！"),!1;e.hasCollect=!e.hasCollect;var a;a=e.hasCollect?1:0,o({method:"POST",url:"/zuiwan-backend/index.php/user/collect_article",data:{article_id:n.params.articleId,action:a}}).then(function(e){console.log(e)},function(e){})}}]);
angular.module("directives",[]).directive("historyBack",function(){return{restrict:"E",template:'<div class="history-back"><i class="icon-back"></i></div>',replace:!0,link:function(i,n,t){n.on("click",function(){window.history.back()})}}}).directive("repeatFinish",function(){return{link:function(i,n,t){1==i.$last&&i.$eval(t.repeatFinish)}}});
angular.module("filters",[]).filter("dateObj",function(){return function(e){var e=new Date(e);return e}}).filter("month",function(){return function(e){var r=["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"];return r[e.getMonth()]+", "+e.getFullYear()}}).filter("day",function(){return function(e){var r=["January","February","March","April","May","June","July","Aguest","September","October","November","December"],t=e.getDate();return 10>t&&(t="0"+t),r[e.getMonth()]+", "+t+", "+e.getFullYear()}});
!function(n,t){var o=n.documentElement,e="orientationchange"in window?"orientationchange":"resize",i=function(){var n=o.clientWidth;if(n){var t=12,e=16,i=320,a=768,d=(n-i)/(a-i),c=d*(e-t)+t;c>e?c=e:t>c&&(c=t),o.style.fontSize=c+"px"}};n.addEventListener&&(t.addEventListener(e,i,!1),n.addEventListener("DOMContentLoaded",i,!1))}(document,window),$(function(){FastClick.attach(document.body);var n=!1,t=$(window).scrollTop();$(window).scroll(function(){var o=$(window).scrollTop();o>t&&!n&&$("#myTab").length?(n=!0,$("#myTab").animate({bottom:"-4.4rem"},300,function(){n=!1})):t>o&&!n&&$("#myTab").length&&(n=!0,$("#myTab").animate({bottom:"0"},300,function(){n=!1})),t=o})});
angular.module("services",[]).factory("cookieService",function(){return{get:function(e){var o=encodeURIComponent(e)+"=",n=document.cookie.indexOf(o),c="";if(n>-1){var t=document.cookie.indexOf(";",n);-1==t&&(t=document.cookie.length),c=decodeURIComponent(document.cookie.substring(n+o.length,t))}return c},exit:function(){document.cookie="zw_username=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/;"}}});
//# sourceMappingURL=build.js.map
